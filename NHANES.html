<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Sociodemographic Associated with HIV Infection from 1999 to 2016</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="Home.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Global HIV Hub</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    About
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="about_hiv.html">Project</a>
    </li>
    <li>
      <a href="team.html">Team</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="analysis_draft.html">HIV Surveillance</a>
</li>
<li>
  <a href="NHANES.html">Risk Factors</a>
</li>
<li>
  <a href="extra_resources.html">Resources</a>
</li>
<li>
  <a href="project_report.html">Final Report</a>
</li>
<li>
  <a href="https://github.com/IamHJJ/p8105_final_project.github.io">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="mailto:&lt;rl3328@cumc.columbia.edu,jh4617@cumc.columbia.edu, xl3214@cumc.columbia.edu, tj2519@cumc.columbia.edu, qs2261@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Sociodemographic Associated with HIV
Infection from 1999 to 2016</h1>

</div>


<div id="data-sources" class="section level1">
<h1>Data Sources</h1>
<p>The <a href="https://wwwn.cdc.gov/nchs/nhanes/">National Health and
Nutrition Examination Survey</a> is designed to evaluate the health and
nutritional status of both adults and children. In 1999, the NHANES
study transitioned into a continuous format, enabling investigators to
conduct longitudinal studies. NHANES encompasses both interview data and
physical examination data, which involved information from different
perspectives and fields, providing researchers with a comprehensive
dataset to examine the prevalence and risk factors associated with
various diseases. In this study, we used the demographic data, HIV
testing, and sexual behavior data from 1999 to 2016 to identify the
potential sociodemographic factors associated with HIV infection
status.</p>
</div>
<div id="study-objectives" class="section level1">
<h1>Study Objectives</h1>
<p>Our study’s primary objective is to analyze the NHANES dataset from
1999 to 2016 to identify sociodemographic factors associated with HIV
infection rates in the United States. By examining variables such as
age, gender, race, education level, and marial status, we aim to
illuminate the complex interplay of societal elements influencing HIV
prevalence. This analysis will provide valuable insights into the
demographics most affected by HIV, guiding public health strategies and
resource allocation to improve prevention and treatment programs.
Through this research, we seek to contribute to a more nuanced
understanding of HIV epidemiology that could underpin targeted
interventions and support the reduction of infection disparities across
diverse population groups.</p>
</div>
<div id="data-cleaning" class="section level1">
<h1>Data Cleaning</h1>
<div id="import-nhanes-datafiles" class="section level2">
<h2>import NHANES datafiles</h2>
<p>The analyzed data sets was downloaded from the <a
href="https://wwwn.cdc.gov/nchs/nhanes/">National Health and Nutrition
Examination Survey Website</a>. Specifically, demographic, HIV test, and
sexual behavior datas from 1999 to 2016 utilized to conducted the
analysis. Participants aged between 20 and 49 with a completed survey
were eligible and included to our study.</p>
<pre class="r"><code>demo_list = 
  list.files(path = &quot;NHANES/DEMO&quot;, full.names = TRUE) 
hiv_list = 
  list.files(path = &quot;NHANES/HIV&quot;, full.names = TRUE) 
sxq_list = 
  list.files(path = &quot;NHANES/SXQ&quot;, full.names = TRUE) 


load_files = function(x){
  
  filetype =
    str_extract(x, &quot;DEMO|HIV|SXQ&quot;)
  
  year = 
    str_extract(x, &quot;(?&lt;=_)[A-Z]&quot;)
  
data = 
    read_xpt(x) |&gt;
    janitor::clean_names()|&gt;
    mutate(filetype = filetype, year = year)
    
}


demo_list_output = 
  map(demo_list, load_files) 

hiv_list_output = 
  map(hiv_list, load_files) 

sxq_list_output = 
  map(sxq_list, load_files)

join_pair = function(df1, df2) {
  left_join(df1, df2, by = c(&quot;seqn&quot;, &quot;year&quot;))
}


hiv_demo_list = 
  map2(hiv_list_output, demo_list_output, ~join_pair(.x, .y))
  
hiv_demo_sxq_df = 
  map2(hiv_demo_list, sxq_list_output, ~join_pair(.x, .y)) |&gt;
  bind_rows() 

cleaned_joined_df = 
  hiv_demo_sxq_df |&gt;
  filter(ridageyr &gt;= 20 &amp; ridageyr &lt;= 49) |&gt;
  mutate(hiv = case_when(
    lbdhi == 1 | lbxhivc == 1 ~ 1,
    lbdhi == 2 | lbxhivc == 2 ~ 2)
    )|&gt; 
  mutate(MSM = case_when(
    year %in% c(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;) ~ sxq220,
    year %in% c(&quot;D&quot;,&quot;E&quot;,&quot;F&quot;,&quot;G&quot;,&quot;H&quot;,&quot;I&quot;) ~ sxq550)
    )|&gt;
   mutate(WSW = case_when(
    year %in% c(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;) ~ sxq150,
    year %in% c(&quot;D&quot;,&quot;E&quot;,&quot;F&quot;,&quot;G&quot;,&quot;H&quot;,&quot;I&quot;) ~ sxq490)
    )|&gt;
  mutate(year = recode(year, 
                       &quot;A&quot; = &quot;1999-2000&quot;,
                       &quot;B&quot; = &quot;2001-2002&quot;,
                       &quot;C&quot; = &quot;2003-2004&quot;,
                       &quot;D&quot; = &quot;2005-2006&quot;,
                       &quot;E&quot; = &quot;2007-2008&quot;,
                       &quot;F&quot; = &quot;2009-2010&quot;,
                       &quot;G&quot; = &quot;2011-2012&quot;,
                       &quot;H&quot; = &quot;2013-2014&quot;,
                       &quot;I&quot; = &quot;2015-2016&quot;),
         hiv = recode(hiv,
                            &quot;1&quot; = &quot;Reactive&quot;,
                            &quot;2&quot; = &quot;Non-reactive&quot;),
         gender = recode(riagendr, 
                         &quot;1&quot; = &quot;Male&quot;,
                         &quot;2&quot; = &quot;Female&quot;),
         age = ridageyr,
         race = recode(ridreth1,
                       &quot;1&quot; = &quot;Mexican American&quot;,
                       &quot;2&quot; = &quot;Other Hispanic&quot;,
                       &quot;3&quot; = &quot;Non-Hispanic White&quot;,
                       &quot;4&quot; = &quot;Non-Hispanic Black&quot;,
                       &quot;5&quot; = &quot;Other Race - Including Multi-Racial&quot;),
         education = recode(dmdeduc2,
                            &quot;1&quot; = &quot;Less than 9th grade&quot;,
                            &quot;2&quot; = &quot;9-11th grade&quot;,
                            &quot;3&quot; = &quot;High school graduate or equivalent&quot;,
                            &quot;4&quot; = &quot;Some college or AA degree&quot;,
                            &quot;5&quot; = &quot;College graduate or above&quot;,
                            &quot;7&quot; = NA_character_,
                            &quot;9&quot; = NA_character_),
         marriage = recode(dmdmartl,
                           &quot;1&quot; = &quot;Married&quot;, 
                           &quot;2&quot; = &quot;Widowed&quot;,
                           &quot;3&quot; = &quot;Divorced&quot;,
                           &quot;4&quot; = &quot;Separated&quot;,
                           &quot;5&quot; = &quot;Never married&quot;,
                           &quot;6&quot; = &quot;Living with partner&quot;,
                           &quot;77&quot; = NA_character_,
                           &quot;99&quot; = NA_character_)
         ) |&gt;
  mutate(samesexcontact = case_when(
    (MSM %in% c(0, 7777, 77777,9999, 99999) | WSW %in% c(0, 7777, 77777, 9999, 99999)) ~ 0,
    (MSM &gt;= 1 &amp; MSM &lt;= 600) | (WSW &gt;= 1 &amp; WSW &lt;= 600) ~ 1
  )) |&gt;
  select(seqn, hiv, age, gender, race, education, marriage, year, samesexcontact)</code></pre>
</div>
</div>
<div id="descriptive-visualization-of-the-potential-risk-factors"
class="section level1">
<h1>Descriptive visualization of the potential risk factors</h1>
<p>To visualize the association between the selected potential risk
factors and HIV test results, we specifically calculated the percent of
participants whose HIV-antibody test showing (lbdhi or lbxhivc)
‘positive’ among all the participants who reported to have a ‘positive’
or ‘negative’ value in the antibody test. We further excluded the
participants whose status is ‘missing’ or ‘indeterminate’ in the
antibody test in our data visualization section.</p>
<p>Then, we plot each bar chart illustrating the integrated (from 1999
to 2016) percentage of ‘positive’ participants on the y-axis and the
risk factor of interest on the x-axis, correlated with a line plot
indicating the change of the ‘positive’ participants for each risk
factor to assess the association between HIV and each risk factor in a
rough way. Besides, the mean age of the positive clusters among each
sub-cohort was also calculated for each characteristic/risk factor.</p>
<div id="write-a-function-to-combine-bar-and-line-plot"
class="section level2">
<h2>Write a function to combine bar and line plot</h2>
<p>We firstly wrote a function for creating the combined plot for each
risk factor.</p>
<pre class="r"><code>combine_plot = function(bar, line, indicator){
  title_g = paste(&quot;Percent of HIV-Antibody Positive Patients from 1999 to 2016 by&quot;, indicator)
  
  combine_bar = 
    subplot(bar, line, margin = 0.1) %&gt;% 
    layout(title = title_g)
  
  annotations = list( 
  list( 
    x = 0.17,  
    y = 0.98,  
    text = &quot;Total Percent&quot;,  
    xref = &quot;paper&quot;,  
    yref = &quot;paper&quot;,  
    xanchor = &quot;center&quot;,  
    yanchor = &quot;bottom&quot;,  
    showarrow = FALSE 
  ),  
  list( 
    x = 0.86,  
    y = 0.98,  
    text = &quot;Percent by Year&quot;,  
    xref = &quot;paper&quot;,  
    yref = &quot;paper&quot;,  
    xanchor = &quot;center&quot;,  
    yanchor = &quot;bottom&quot;,  
    showarrow = FALSE 
  )) 
  
  combine_bar = combine_bar %&gt;% 
  layout(annotations = annotations)
  
}</code></pre>
</div>
<div id="race-and-the-percent-of-positive-in-hiv-antibody-test"
class="section level2">
<h2>Race and the Percent of ‘Positive’ in HIV Antibody Test</h2>
<pre class="r"><code>bar_race = 
  cleaned_joined_df %&gt;% 
  drop_na(hiv) %&gt;% 
  group_by(race) %&gt;%
  summarize(total_par = n(), 
            age_mean = round(mean(age[hiv == &quot;Reactive&quot;]), 2), 
            hiv_percent = round(sum(hiv == &quot;Reactive&quot;) / total_par * 100, 3)) %&gt;%
  ungroup() %&gt;% 
  mutate(race = fct_reorder(race, hiv_percent)) %&gt;% 
  mutate(text_label = str_c(&quot;mean age: &quot;, age_mean, &quot;, Positive HIV Percent: &quot;, hiv_percent, &quot;%&quot;)) %&gt;% 
  plot_ly(x = ~race, y = ~hiv_percent, color = ~race, type = &quot;bar&quot;, text = ~text_label)

line_race =
  cleaned_joined_df %&gt;% 
  drop_na(hiv) %&gt;% 
  group_by(year, race) %&gt;% 
  summarize(total_par = n(), 
            age_mean = round(mean(age[hiv == &quot;Reactive&quot;]), 2), 
            hiv_percent = round(sum(hiv == &quot;Reactive&quot;) / total_par * 100, 3)) %&gt;%
  ungroup() %&gt;% 
  mutate(race = fct_reorder(race, hiv_percent)) %&gt;% 
  mutate(text_label = str_c(&quot;mean age: &quot;, age_mean, &quot;, Positive HIV Percent: &quot;, hiv_percent, &quot;%&quot;)) %&gt;% 
  plot_ly(x = ~year, y = ~hiv_percent, color = ~race, type = &quot;scatter&quot;, mode = &quot;lines+markers&quot;,
          text = ~text_label) 


combine_race = combine_plot(bar_race, line_race, &quot;Race&quot;)

combine_race </code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ed8576bd2753d02da0ba" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-ed8576bd2753d02da0ba">{"x":{"data":[{"x":["Other Race - Including Multi-Racial"],"y":[0.045999999999999999],"text":"mean age: 47, Positive HIV Percent: 0.046%","type":"bar","name":"Other Race - Including Multi-Racial","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Non-Hispanic White"],"y":[0.17999999999999999],"text":"mean age: 38.12, Positive HIV Percent: 0.18%","type":"bar","name":"Non-Hispanic White","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mexican American"],"y":[0.25],"text":"mean age: 35.75, Positive HIV Percent: 0.25%","type":"bar","name":"Mexican American","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Other Hispanic"],"y":[0.46899999999999997],"text":"mean age: 40.56, Positive HIV Percent: 0.469%","type":"bar","name":"Other Hispanic","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Non-Hispanic Black"],"y":[1.7709999999999999],"text":"mean age: 36.42, Positive HIV Percent: 1.771%","type":"bar","name":"Non-Hispanic Black","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"y":[0,0,0,0,0.83999999999999997,0,0,0,0],"mode":"lines+markers","text":["mean age: NaN, Positive HIV Percent: 0%","mean age: NaN, Positive HIV Percent: 0%","mean age: NaN, Positive HIV Percent: 0%","mean age: NaN, Positive HIV Percent: 0%","mean age: 47, Positive HIV Percent: 0.84%","mean age: NaN, Positive HIV Percent: 0%","mean age: NaN, Positive HIV Percent: 0%","mean age: NaN, Positive HIV Percent: 0%","mean age: NaN, Positive HIV Percent: 0%"],"type":"scatter","name":"Other Race - Including Multi-Racial","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"y":[0.22500000000000001,0.083000000000000004,0.27600000000000002,0.35999999999999999,0.091999999999999998,0.076999999999999999,0.111,0.090999999999999998,0.39600000000000002],"mode":"lines+markers","text":["mean age: 33.5, Positive HIV Percent: 0.225%","mean age: 27, Positive HIV Percent: 0.083%","mean age: 37.33, Positive HIV Percent: 0.276%","mean age: 46.25, Positive HIV Percent: 0.36%","mean age: 42, Positive HIV Percent: 0.092%","mean age: 22, Positive HIV Percent: 0.077%","mean age: 29, Positive HIV Percent: 0.111%","mean age: 41, Positive HIV Percent: 0.091%","mean age: 41, Positive HIV Percent: 0.396%"],"type":"scatter","name":"Non-Hispanic White","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"y":[0,0.58599999999999997,0.40100000000000002,0.156,0.184,0.503,0.32800000000000001,0,0],"mode":"lines+markers","text":["mean age: NaN, Positive HIV Percent: 0%","mean age: 37.25, Positive HIV Percent: 0.586%","mean age: 28.5, Positive HIV Percent: 0.401%","mean age: 32, Positive HIV Percent: 0.156%","mean age: 44, Positive HIV Percent: 0.184%","mean age: 34.67, Positive HIV Percent: 0.503%","mean age: 43, Positive HIV Percent: 0.328%","mean age: NaN, Positive HIV Percent: 0%","mean age: NaN, Positive HIV Percent: 0%"],"type":"scatter","name":"Mexican American","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"y":[0,1.575,1.1240000000000001,0.88500000000000001,0.65800000000000003,0.60199999999999998,0.433,0,0],"mode":"lines+markers","text":["mean age: NaN, Positive HIV Percent: 0%","mean age: 36, Positive HIV Percent: 1.575%","mean age: 35, Positive HIV Percent: 1.124%","mean age: 39, Positive HIV Percent: 0.885%","mean age: 46.5, Positive HIV Percent: 0.658%","mean age: 40.5, Positive HIV Percent: 0.602%","mean age: 45, Positive HIV Percent: 0.433%","mean age: NaN, Positive HIV Percent: 0%","mean age: NaN, Positive HIV Percent: 0%"],"type":"scatter","name":"Other Hispanic","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"line":{"color":"rgba(231,138,195,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"y":[3.4009999999999998,1.2889999999999999,1.6419999999999999,2,1.417,2.028,1.4930000000000001,2.2989999999999999,0.71899999999999997],"mode":"lines+markers","text":["mean age: 39.73, Positive HIV Percent: 3.401%","mean age: 37.71, Positive HIV Percent: 1.289%","mean age: 36.22, Positive HIV Percent: 1.642%","mean age: 36.08, Positive HIV Percent: 2%","mean age: 33, Positive HIV Percent: 1.417%","mean age: 37.5, Positive HIV Percent: 2.028%","mean age: 37.33, Positive HIV Percent: 1.493%","mean age: 33.58, Positive HIV Percent: 2.299%","mean age: 33, Positive HIV Percent: 0.719%"],"type":"scatter","name":"Non-Hispanic Black","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"line":{"color":"rgba(166,216,84,1)"},"xaxis":"x2","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,0.40000000000000002],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["Other Race - Including Multi-Racial","Non-Hispanic White","Mexican American","Other Hispanic","Non-Hispanic Black"],"anchor":"y"},"xaxis2":{"domain":[0.59999999999999998,1],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"anchor":"y2"},"yaxis2":{"domain":[0,1],"automargin":true,"anchor":"x2"},"yaxis":{"domain":[0,1],"automargin":true,"anchor":"x"},"annotations":[{"x":0.17000000000000001,"y":0.97999999999999998,"text":"Total Percent","xref":"paper","yref":"paper","xanchor":"center","yanchor":"bottom","showarrow":false},{"x":0.85999999999999999,"y":0.97999999999999998,"text":"Percent by Year","xref":"paper","yref":"paper","xanchor":"center","yanchor":"bottom","showarrow":false}],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":true,"title":"Percent of HIV-Antibody Positive Patients from 1999 to 2016 by Race"},"attrs":{"abc255ce0812":{"x":{},"y":{},"text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"},"abc2497401c0":{"x":{},"y":{},"mode":"lines+markers","text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>The bar plot shown the percent of patients with a positive result
from the HIV antibody test in each race when we integrated all datasets
from 1999 to 2016. It indicated that the race Non-Hispanic Black has
reported the highest percent, while the ‘Other Race’ had the lowest
percent. From the bar plot, disparity among the races. The line plot
shows the change in the reported, positive percent of HIV-antibody test
from 1999 to 2016. We could observe that the trend in each race are
different, but the Non-Hispanic Black and Other Hispanic had a
decreasing trend over 1999 to 2016. From the two plots, we found that
the mean age in each race and each year were also different.</p>
</div>
<div id="sex-and-the-percent-of-positive-in-hiv-antibody-test"
class="section level2">
<h2>Sex and the Percent of ‘Positive’ in HIV Antibody Test</h2>
<pre class="r"><code>bar_gender = 
  cleaned_joined_df %&gt;% 
  drop_na(hiv) %&gt;% 
  group_by(gender) %&gt;%
  summarize(total_par = n(), 
            age_mean = round(mean(age[hiv == &quot;Reactive&quot;]), 2), 
            hiv_percent = round(sum(hiv == &quot;Reactive&quot;) / total_par * 100, 3)) %&gt;%
  ungroup() %&gt;% 
  mutate(text_label = str_c(&quot;mean age: &quot;, age_mean, &quot;, Positive HIV Percent: &quot;, hiv_percent, &quot;%&quot;)) %&gt;% 
  plot_ly(x = ~gender, y = ~hiv_percent, color = ~gender, type = &quot;bar&quot;, text = ~text_label)


line_gender = 
  cleaned_joined_df %&gt;% 
  drop_na(hiv) %&gt;% 
  group_by(year, gender) %&gt;% 
  summarize(total_par = n(), 
            age_mean = round(mean(age[hiv == &quot;Reactive&quot;]), 2), 
            hiv_percent = round(sum(hiv == &quot;Reactive&quot;) / total_par * 100, 3)) %&gt;%
  ungroup() %&gt;% 
  mutate(text_label = str_c(&quot;mean age: &quot;, age_mean, &quot;, Positive HIV Percent: &quot;, hiv_percent, &quot;%&quot;)) %&gt;% 
  plot_ly(x = ~year, y = ~hiv_percent, color = ~gender, type = &quot;scatter&quot;, mode = &quot;lines+markers&quot;,
          text = ~text_label)

combine_gender = combine_plot(bar_gender, line_gender, &quot;Gender&quot;)
combine_gender</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f53de354ad870c424059" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-f53de354ad870c424059">{"x":{"data":[{"x":["Female"],"y":[0.27700000000000002],"text":"mean age: 39.24, Positive HIV Percent: 0.277%","type":"bar","name":"Female","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Male"],"y":[0.83199999999999996],"text":"mean age: 36.12, Positive HIV Percent: 0.832%","type":"bar","name":"Male","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"y":[0.32500000000000001,0.48499999999999999,0.40899999999999997,0.28199999999999997,0.075999999999999998,0.25700000000000001,0.23400000000000001,0.20899999999999999,0.218],"mode":"lines+markers","text":["mean age: 40.75, Positive HIV Percent: 0.325%","mean age: 36.71, Positive HIV Percent: 0.485%","mean age: 35, Positive HIV Percent: 0.409%","mean age: 42.75, Positive HIV Percent: 0.282%","mean age: 47, Positive HIV Percent: 0.076%","mean age: 39.5, Positive HIV Percent: 0.257%","mean age: 44.67, Positive HIV Percent: 0.234%","mean age: 43, Positive HIV Percent: 0.209%","mean age: 33.33, Positive HIV Percent: 0.218%"],"type":"scatter","name":"Female","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"y":[1.325,0.57899999999999996,0.91000000000000003,1.2050000000000001,0.89600000000000002,0.88200000000000001,0.71299999999999997,0.76300000000000001,0.33200000000000002],"mode":"lines+markers","text":["mean age: 38.46, Positive HIV Percent: 1.325%","mean age: 36.43, Positive HIV Percent: 0.579%","mean age: 35.5, Positive HIV Percent: 0.91%","mean age: 37, Positive HIV Percent: 1.205%","mean age: 37.27, Positive HIV Percent: 0.896%","mean age: 35.33, Positive HIV Percent: 0.882%","mean age: 35.44, Positive HIV Percent: 0.713%","mean age: 31.5, Positive HIV Percent: 0.763%","mean age: 38.75, Positive HIV Percent: 0.332%"],"type":"scatter","name":"Male","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x2","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,0.40000000000000002],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["Female","Male"],"anchor":"y"},"xaxis2":{"domain":[0.59999999999999998,1],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"anchor":"y2"},"yaxis2":{"domain":[0,1],"automargin":true,"anchor":"x2"},"yaxis":{"domain":[0,1],"automargin":true,"anchor":"x"},"annotations":[{"x":0.17000000000000001,"y":0.97999999999999998,"text":"Total Percent","xref":"paper","yref":"paper","xanchor":"center","yanchor":"bottom","showarrow":false},{"x":0.85999999999999999,"y":0.97999999999999998,"text":"Percent by Year","xref":"paper","yref":"paper","xanchor":"center","yanchor":"bottom","showarrow":false}],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":true,"title":"Percent of HIV-Antibody Positive Patients from 1999 to 2016 by Gender"},"attrs":{"abc26ec495bd":{"x":{},"y":{},"text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"},"abc22c42e41b":{"x":{},"y":{},"mode":"lines+markers","text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>The bar plot and the line plot indicated that male has reported much
higher percent than females. From the line plot, we observed that the
positive percent were decreasing in each sex. From the two plots, we
found that the mean age in females appeared to be slightly higher than
males among the patients with a positive test result.</p>
</div>
<div
id="education-level-and-the-percent-of-positive-in-hiv-antibody-test"
class="section level2">
<h2>Education Level and the Percent of ‘Positive’ in HIV Antibody
Test</h2>
<pre class="r"><code>bar_edu = 
cleaned_joined_df %&gt;% 
  drop_na(hiv) %&gt;% 
  group_by(education) %&gt;%
  summarize(total_par = n(), 
            age_mean = round(mean(age[hiv == &quot;Reactive&quot;]), 2), 
            hiv_percent = round(sum(hiv == &quot;Reactive&quot;) / total_par * 100, 3)) %&gt;%
  ungroup() %&gt;% 
  mutate(education = forcats::fct_relevel(education, c(&quot;Less than 9th grade&quot;, &quot;9-11th grade&quot;, 
                                         &quot;High school graduate or equivalent&quot;, 
                                         &quot;Some college or AA degree&quot;,
                                         &quot;College graduate or above&quot;))) %&gt;% 
  mutate(text_label = str_c(&quot;mean age: &quot;, age_mean, &quot;, Positive HIV Percent: &quot;, hiv_percent, &quot;%&quot;)) %&gt;% 
  plot_ly(x = ~education, y = ~hiv_percent, color = ~education, type = &quot;bar&quot;, text = ~text_label)


line_edu =
  cleaned_joined_df %&gt;% 
  drop_na(hiv) %&gt;% 
  group_by(year, education) %&gt;% 
  summarize(total_par = n(), 
            age_mean = round(mean(age[hiv == &quot;Reactive&quot;]), 2), 
            hiv_percent = round(sum(hiv == &quot;Reactive&quot;) / total_par * 100, 3)) %&gt;%
  ungroup() %&gt;% 
  mutate(education = forcats::fct_relevel(education, c(&quot;Less than 9th grade&quot;, &quot;9-11th grade&quot;, 
                                         &quot;High school graduate or equivalent&quot;, 
                                         &quot;Some college or AA degree&quot;,
                                         &quot;College graduate or above&quot;))) %&gt;% 
  mutate(text_label = str_c(&quot;mean age: &quot;, age_mean, &quot;, Positive HIV Percent: &quot;, hiv_percent, &quot;%&quot;)) %&gt;% 
  plot_ly(x = ~year, y = ~hiv_percent, color = ~education, type = &quot;scatter&quot;, mode = &quot;lines+markers&quot;,
          text = ~text_label) 


combine_edu = combine_plot(bar_edu, line_edu, &quot;Education&quot;)
combine_edu </code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0382d155fa143a85d780" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-0382d155fa143a85d780">{"x":{"data":[{"x":["Less than 9th grade"],"y":[0.33200000000000002],"text":"mean age: 36.67, Positive HIV Percent: 0.332%","type":"bar","name":"Less than 9th grade","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["9-11th grade"],"y":[0.81000000000000005],"text":"mean age: 37.1, Positive HIV Percent: 0.81%","type":"bar","name":"9-11th grade","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["High school graduate or equivalent"],"y":[0.56699999999999995],"text":"mean age: 36.8, Positive HIV Percent: 0.567%","type":"bar","name":"High school graduate or equivalent","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Some college or AA degree"],"y":[0.59999999999999998],"text":"mean age: 37.23, Positive HIV Percent: 0.6%","type":"bar","name":"Some college or AA degree","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["College graduate or above"],"y":[0.28599999999999998],"text":"mean age: 35.8, Positive HIV Percent: 0.286%","type":"bar","name":"College graduate or above","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"y":[0.437,0.35999999999999999,0,0.43099999999999999,0.495,0.38500000000000001,0.80600000000000005,0,0],"mode":"lines+markers","text":["mean age: 30, Positive HIV Percent: 0.437%","mean age: 30, Positive HIV Percent: 0.36%","mean age: NaN, Positive HIV Percent: 0%","mean age: 39, Positive HIV Percent: 0.431%","mean age: 44, Positive HIV Percent: 0.495%","mean age: 34, Positive HIV Percent: 0.385%","mean age: 43, Positive HIV Percent: 0.806%","mean age: NaN, Positive HIV Percent: 0%","mean age: NaN, Positive HIV Percent: 0%"],"type":"scatter","name":"Less than 9th grade","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"y":[1.345,0.92200000000000004,0.53900000000000003,1.4890000000000001,0.82799999999999996,0.64200000000000002,0.61699999999999999,0.54300000000000004,0],"mode":"lines+markers","text":["mean age: 41.33, Positive HIV Percent: 1.345%","mean age: 37, Positive HIV Percent: 0.922%","mean age: 27, Positive HIV Percent: 0.539%","mean age: 37, Positive HIV Percent: 1.489%","mean age: 38, Positive HIV Percent: 0.828%","mean age: 36, Positive HIV Percent: 0.642%","mean age: 37, Positive HIV Percent: 0.617%","mean age: 35, Positive HIV Percent: 0.543%","mean age: NaN, Positive HIV Percent: 0%"],"type":"scatter","name":"9-11th grade","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"y":[0.191,0.46899999999999997,1.631,0,0.63400000000000001,0.89800000000000002,0.60399999999999998,0.16600000000000001,0.374],"mode":"lines+markers","text":["mean age: 45, Positive HIV Percent: 0.191%","mean age: 37.33, Positive HIV Percent: 0.469%","mean age: 37.9, Positive HIV Percent: 1.631%","mean age: NaN, Positive HIV Percent: 0%","mean age: 38, Positive HIV Percent: 0.634%","mean age: 36.17, Positive HIV Percent: 0.898%","mean age: 40.67, Positive HIV Percent: 0.604%","mean age: 27, Positive HIV Percent: 0.166%","mean age: 25, Positive HIV Percent: 0.374%"],"type":"scatter","name":"High school graduate or equivalent","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"y":[1.1930000000000001,0.51700000000000002,0.27800000000000002,1.0840000000000001,0.26900000000000002,0.224,0.58199999999999996,0.86099999999999999,0.48099999999999998],"mode":"lines+markers","text":["mean age: 36.71, Positive HIV Percent: 1.193%","mean age: 38.25, Positive HIV Percent: 0.517%","mean age: 28.5, Positive HIV Percent: 0.278%","mean age: 39.89, Positive HIV Percent: 1.084%","mean age: 35, Positive HIV Percent: 0.269%","mean age: 32.5, Positive HIV Percent: 0.224%","mean age: 36.4, Positive HIV Percent: 0.582%","mean age: 35, Positive HIV Percent: 0.861%","mean age: 44.5, Positive HIV Percent: 0.481%"],"type":"scatter","name":"Some college or AA degree","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"line":{"color":"rgba(231,138,195,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"y":[0.23699999999999999,0.38200000000000001,0.215,0.373,0.20399999999999999,0.64000000000000001,0.13500000000000001,0.27600000000000002,0.13700000000000001],"mode":"lines+markers","text":["mean age: 36, Positive HIV Percent: 0.237%","mean age: 34.5, Positive HIV Percent: 0.382%","mean age: 40, Positive HIV Percent: 0.215%","mean age: 34.5, Positive HIV Percent: 0.373%","mean age: 39, Positive HIV Percent: 0.204%","mean age: 39.5, Positive HIV Percent: 0.64%","mean age: 32, Positive HIV Percent: 0.135%","mean age: 33.5, Positive HIV Percent: 0.276%","mean age: 27, Positive HIV Percent: 0.137%"],"type":"scatter","name":"College graduate or above","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"line":{"color":"rgba(166,216,84,1)"},"xaxis":"x2","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,0.40000000000000002],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["Less than 9th grade","9-11th grade","High school graduate or equivalent","Some college or AA degree","College graduate or above"],"anchor":"y"},"xaxis2":{"domain":[0.59999999999999998,1],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"anchor":"y2"},"yaxis2":{"domain":[0,1],"automargin":true,"anchor":"x2"},"yaxis":{"domain":[0,1],"automargin":true,"anchor":"x"},"annotations":[{"x":0.17000000000000001,"y":0.97999999999999998,"text":"Total Percent","xref":"paper","yref":"paper","xanchor":"center","yanchor":"bottom","showarrow":false},{"x":0.85999999999999999,"y":0.97999999999999998,"text":"Percent by Year","xref":"paper","yref":"paper","xanchor":"center","yanchor":"bottom","showarrow":false}],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":true,"title":"Percent of HIV-Antibody Positive Patients from 1999 to 2016 by Education"},"attrs":{"abc2370b4c25":{"x":{},"y":{},"text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"},"abc246b42d5e":{"x":{},"y":{},"mode":"lines+markers","text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>The bar plot indicated that the group with education level of ‘9-11th
grade’ has reported the highest percent, while the ‘College graduate or
above’ had the lowest percent; disparity among the education was also
observed. From the line plot, we observed that the trend over 1999 to
2016 in each education level are different, but with a decreasing
overall trend. From the two plots, we found that the mean age in each
race and each year were also different, and it is hard to find a
trend.</p>
</div>
<div
id="marital-status-and-the-percent-of-positive-in-hiv-antibody-test"
class="section level2">
<h2>Marital status and the Percent of ‘Positive’ in HIV Antibody
Test</h2>
<pre class="r"><code>bar_mar = 
  cleaned_joined_df %&gt;% 
  drop_na(hiv) %&gt;% 
  group_by(marriage) %&gt;%
  summarize(total_par = n(), 
            age_mean = round(mean(age[hiv == &quot;Reactive&quot;]), 2), 
            hiv_percent = round(sum(hiv == &quot;Reactive&quot;) / total_par * 100, 3)) %&gt;%
  ungroup() %&gt;% 
  mutate(marriage = fct_reorder(marriage, hiv_percent)) %&gt;% 
  mutate(text_label = str_c(&quot;mean age: &quot;, age_mean, &quot;, Positive HIV Percent: &quot;, hiv_percent, &quot;%&quot;)) %&gt;% 
  plot_ly(x = ~marriage, y = ~hiv_percent, color = ~marriage, type = &quot;bar&quot;, text = ~text_label) 


line_mar =
  cleaned_joined_df %&gt;% 
  drop_na(hiv, marriage) %&gt;% 
  group_by(year, marriage) %&gt;% 
  summarize(total_par = n(), 
            age_mean = round(mean(age[hiv == &quot;Reactive&quot;]), 2), 
            hiv_percent = round(sum(hiv == &quot;Reactive&quot;) / total_par * 100, 3)) %&gt;%
  ungroup() %&gt;% 
  mutate(marriage = fct_reorder(marriage, hiv_percent)) %&gt;% 
  mutate(text_label = str_c(&quot;mean age: &quot;, age_mean, &quot;, Positive HIV Percent: &quot;, hiv_percent, &quot;%&quot;)) %&gt;% 
  plot_ly(x = ~year, y = ~hiv_percent, color = ~marriage, type = &quot;scatter&quot;, mode = &quot;lines+markers&quot;,
          text = ~text_label) 

combine_mar = combine_plot(bar_mar, line_mar, &quot;Marital Status&quot;)
combine_mar</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-22e57090d5f725a505bb" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-22e57090d5f725a505bb">{"x":{"data":[{"x":["Married"],"y":[0.23899999999999999],"text":"mean age: 41.26, Positive HIV Percent: 0.239%","type":"bar","name":"Married","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Divorced"],"y":[0.48099999999999998],"text":"mean age: 43.62, Positive HIV Percent: 0.481%","type":"bar","name":"Divorced","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Living with partner"],"y":[0.64900000000000002],"text":"mean age: 36.82, Positive HIV Percent: 0.649%","type":"bar","name":"Living with partner","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Separated"],"y":[0.74299999999999999],"text":"mean age: 40.17, Positive HIV Percent: 0.743%","type":"bar","name":"Separated","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Never married"],"y":[0.96699999999999997],"text":"mean age: 34.13, Positive HIV Percent: 0.967%","type":"bar","name":"Never married","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Widowed"],"y":[1.361],"text":"mean age: 36.5, Positive HIV Percent: 1.361%","type":"bar","name":"Widowed","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"y":[0,0,5,0,0,5,0,0,0],"mode":"lines+markers","text":["mean age: NaN, Positive HIV Percent: 0%","mean age: NaN, Positive HIV Percent: 0%","mean age: 28, Positive HIV Percent: 5%","mean age: NaN, Positive HIV Percent: 0%","mean age: NaN, Positive HIV Percent: 0%","mean age: 45, Positive HIV Percent: 5%","mean age: NaN, Positive HIV Percent: 0%","mean age: NaN, Positive HIV Percent: 0%","mean age: NaN, Positive HIV Percent: 0%"],"type":"scatter","name":"Widowed","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"y":[0.19500000000000001,0.20399999999999999,0.17499999999999999,0.28899999999999998,0.24199999999999999,0.36599999999999999,0.26500000000000001,0.14899999999999999,0.248],"mode":"lines+markers","text":["mean age: 43.5, Positive HIV Percent: 0.195%","mean age: 42.67, Positive HIV Percent: 0.204%","mean age: 40, Positive HIV Percent: 0.175%","mean age: 41.75, Positive HIV Percent: 0.289%","mean age: 42.33, Positive HIV Percent: 0.242%","mean age: 38, Positive HIV Percent: 0.366%","mean age: 41.67, Positive HIV Percent: 0.265%","mean age: 43.5, Positive HIV Percent: 0.149%","mean age: 41, Positive HIV Percent: 0.248%"],"type":"scatter","name":"Married","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"y":[1.333,0.60199999999999998,1.093,1.266,0.46700000000000003,0,0,0,0],"mode":"lines+markers","text":["mean age: 47, Positive HIV Percent: 1.333%","mean age: 40, Positive HIV Percent: 0.602%","mean age: 44, Positive HIV Percent: 1.093%","mean age: 39, Positive HIV Percent: 1.266%","mean age: 49, Positive HIV Percent: 0.467%","mean age: NaN, Positive HIV Percent: 0%","mean age: NaN, Positive HIV Percent: 0%","mean age: NaN, Positive HIV Percent: 0%","mean age: NaN, Positive HIV Percent: 0%"],"type":"scatter","name":"Divorced","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"y":[1.4179999999999999,0,1.2769999999999999,1.4790000000000001,1.0069999999999999,0.80000000000000004,0,0.32400000000000001,0],"mode":"lines+markers","text":["mean age: 34.5, Positive HIV Percent: 1.418%","mean age: NaN, Positive HIV Percent: 0%","mean age: 33, Positive HIV Percent: 1.277%","mean age: 40.6, Positive HIV Percent: 1.479%","mean age: 37, Positive HIV Percent: 1.007%","mean age: 35.67, Positive HIV Percent: 0.8%","mean age: NaN, Positive HIV Percent: 0%","mean age: 37, Positive HIV Percent: 0.324%","mean age: NaN, Positive HIV Percent: 0%"],"type":"scatter","name":"Living with partner","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"line":{"color":"rgba(231,138,195,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"y":[1.923,1.01,1.266,0,1,0.90100000000000002,0,0,0],"mode":"lines+markers","text":["mean age: 45.5, Positive HIV Percent: 1.923%","mean age: 33, Positive HIV Percent: 1.01%","mean age: 40, Positive HIV Percent: 1.266%","mean age: NaN, Positive HIV Percent: 0%","mean age: 44, Positive HIV Percent: 1%","mean age: 33, Positive HIV Percent: 0.901%","mean age: NaN, Positive HIV Percent: 0%","mean age: NaN, Positive HIV Percent: 0%","mean age: NaN, Positive HIV Percent: 0%"],"type":"scatter","name":"Separated","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"line":{"color":"rgba(166,216,84,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"y":[1.143,1.3680000000000001,0.91200000000000003,1.1399999999999999,0.58699999999999997,0.75900000000000001,1.0609999999999999,1.252,0.54600000000000004],"mode":"lines+markers","text":["mean age: 37, Positive HIV Percent: 1.143%","mean age: 34.56, Positive HIV Percent: 1.368%","mean age: 32.5, Positive HIV Percent: 0.912%","mean age: 34.43, Positive HIV Percent: 1.14%","mean age: 31.5, Positive HIV Percent: 0.587%","mean age: 34.5, Positive HIV Percent: 0.759%","mean age: 36.44, Positive HIV Percent: 1.061%","mean age: 32, Positive HIV Percent: 1.252%","mean age: 33, Positive HIV Percent: 0.546%"],"type":"scatter","name":"Never married","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"line":{"color":"rgba(255,217,47,1)"},"xaxis":"x2","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,0.40000000000000002],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["Married","Divorced","Living with partner","Separated","Never married","Widowed"],"anchor":"y"},"xaxis2":{"domain":[0.59999999999999998,1],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"anchor":"y2"},"yaxis2":{"domain":[0,1],"automargin":true,"anchor":"x2"},"yaxis":{"domain":[0,1],"automargin":true,"anchor":"x"},"annotations":[{"x":0.17000000000000001,"y":0.97999999999999998,"text":"Total Percent","xref":"paper","yref":"paper","xanchor":"center","yanchor":"bottom","showarrow":false},{"x":0.85999999999999999,"y":0.97999999999999998,"text":"Percent by Year","xref":"paper","yref":"paper","xanchor":"center","yanchor":"bottom","showarrow":false}],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":true,"title":"Percent of HIV-Antibody Positive Patients from 1999 to 2016 by Marital Status"},"attrs":{"abc237c6dcf4":{"x":{},"y":{},"text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"},"abc260d433c7":{"x":{},"y":{},"mode":"lines+markers","text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>The bar plot indicated that the ‘widowed’ has reported the highest
percent, while the ‘married’ had the lowest percent. From the line plot,
we observed that the trend over 1999 to 2016 in each education level are
different, but with a decreasing overall trend (except for ‘widowed’,
which seemed to be an outlier). From the two plots, we found that the
mean age in each marital status group and each year also had
disparities, and it was hard to find a trend.</p>
</div>
<div
id="same-sex-sexual-behavior-and-the-percent-of-positive-in-hiv-antibody-test"
class="section level2">
<h2>Same-sex Sexual Behavior and the Percent of ‘Positive’ in HIV
Antibody Test</h2>
<pre class="r"><code>bar_sexbehave = 
  cleaned_joined_df %&gt;%
  drop_na(hiv) %&gt;% 
  mutate(samesexcontact = recode(samesexcontact, &quot;0&quot; = &quot;No same-sex sexual behavior&quot;, 
                                  &quot;1&quot; = &quot;Has same-sex sexual behavior&quot;)) %&gt;% 
  group_by(samesexcontact) %&gt;% 
  summarize(total_par = n(), 
            age_mean = round(mean(age[hiv == &quot;Reactive&quot;]), 2), 
            hiv_percent = round(sum(hiv == &quot;Reactive&quot;) / total_par * 100, 3)) %&gt;% 
  ungroup() %&gt;% 
  mutate(text_label = str_c(&quot;mean age: &quot;, age_mean, &quot;, Positive HIV Percent: &quot;, hiv_percent, &quot;%&quot;)) %&gt;% 
  plot_ly(x = ~samesexcontact, y = ~hiv_percent, color = ~samesexcontact, type = &quot;bar&quot;, text = ~text_label) 

line_sexbehave =
  cleaned_joined_df %&gt;% 
  drop_na(hiv, samesexcontact) %&gt;% 
  mutate(samesexcontact = recode(samesexcontact, &quot;0&quot; = &quot;No same-sex sexual behavior&quot;, 
                                  &quot;1&quot; = &quot;Has same-sex sexual behavior&quot;)) %&gt;% 
  group_by(year, samesexcontact) %&gt;% 
  summarize(total_par = n(), 
            age_mean = round(mean(age[hiv == &quot;Reactive&quot;]), 2), 
            hiv_percent = round(sum(hiv == &quot;Reactive&quot;) / total_par * 100, 3)) %&gt;%
  ungroup() %&gt;% 
  mutate(text_label = str_c(&quot;mean age: &quot;, age_mean, &quot;, Positive HIV Percent: &quot;, hiv_percent, &quot;%&quot;)) %&gt;% 
  plot_ly(x = ~year, y = ~hiv_percent, color = ~samesexcontact, type = &quot;scatter&quot;, mode = &quot;lines+markers&quot;,
          text = ~text_label) 


combine_sexbehave = combine_plot(bar_sexbehave, line_sexbehave, &quot;Sexual Behavior&quot;)
combine_sexbehave</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-1d5100835ab56326953d" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-1d5100835ab56326953d">{"x":{"data":[{"x":["Has same-sex sexual behavior"],"y":[7.742],"text":"mean age: 34.04, Positive HIV Percent: 7.742%","type":"bar","name":"Has same-sex sexual behavior","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["No same-sex sexual behavior"],"y":[0.48099999999999998],"text":"mean age: 38.91, Positive HIV Percent: 0.481%","type":"bar","name":"No same-sex sexual behavior","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"y":[8,10.345000000000001,5.3570000000000002,9.5239999999999991,8.6959999999999997,4.7619999999999996,8.4510000000000005,9.1950000000000003,6.0979999999999999],"mode":"lines+markers","text":["mean age: 29.75, Positive HIV Percent: 8%","mean age: 35, Positive HIV Percent: 10.345%","mean age: 30.67, Positive HIV Percent: 5.357%","mean age: 39, Positive HIV Percent: 9.524%","mean age: 36.67, Positive HIV Percent: 8.696%","mean age: 35.75, Positive HIV Percent: 4.762%","mean age: 34.33, Positive HIV Percent: 8.451%","mean age: 28.5, Positive HIV Percent: 9.195%","mean age: 36.4, Positive HIV Percent: 6.098%"],"type":"scatter","name":"Has same-sex sexual behavior","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"y":[0.65000000000000002,0.316,0.51000000000000001,1,0.36499999999999999,0,1.835,0,0],"mode":"lines+markers","text":["mean age: 41.42, Positive HIV Percent: 0.65%","mean age: 37.43, Positive HIV Percent: 0.316%","mean age: 35.6, Positive HIV Percent: 0.51%","mean age: 45, Positive HIV Percent: 1%","mean age: 49, Positive HIV Percent: 0.365%","mean age: NaN, Positive HIV Percent: 0%","mean age: 37.5, Positive HIV Percent: 1.835%","mean age: NaN, Positive HIV Percent: 0%","mean age: NaN, Positive HIV Percent: 0%"],"type":"scatter","name":"No same-sex sexual behavior","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x2","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,0.40000000000000002],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["Has same-sex sexual behavior","No same-sex sexual behavior"],"anchor":"y"},"xaxis2":{"domain":[0.59999999999999998,1],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["1999-2000","2001-2002","2003-2004","2005-2006","2007-2008","2009-2010","2011-2012","2013-2014","2015-2016"],"anchor":"y2"},"yaxis2":{"domain":[0,1],"automargin":true,"anchor":"x2"},"yaxis":{"domain":[0,1],"automargin":true,"anchor":"x"},"annotations":[{"x":0.17000000000000001,"y":0.97999999999999998,"text":"Total Percent","xref":"paper","yref":"paper","xanchor":"center","yanchor":"bottom","showarrow":false},{"x":0.85999999999999999,"y":0.97999999999999998,"text":"Percent by Year","xref":"paper","yref":"paper","xanchor":"center","yanchor":"bottom","showarrow":false}],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":true,"title":"Percent of HIV-Antibody Positive Patients from 1999 to 2016 by Sexual Behavior"},"attrs":{"abc2966a2d":{"x":{},"y":{},"text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"},"abc21314b0a8":{"x":{},"y":{},"mode":"lines+markers","text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>The bar plot and the line plot indicated that the population has
same-sex sexual behavior has reported much higher percent than the
population without same-sex sexual behavior. From the line plot, we
observed that the positive percent fluctuated a lot among the group that
has same-sex sexual behavior; while in the group that without same-sex
sexual behavior, the the positive percent in each year did not fluctuate
as much. From the two plots, we found that the mean age in the group
that has same-sex sexual behavior appeared to be higher than the group
without same-sex sexual behavior.</p>
</div>
</div>
<div id="logistic-regression" class="section level1">
<h1>logistic regression</h1>
<div id="set-the-reference-group" class="section level2">
<h2>Set the reference group</h2>
<pre class="r"><code>cleaned_regression_df= 
   cleaned_joined_df |&gt; 
   mutate(
      hiv_outcome = ifelse(hiv == &quot;Reactive&quot;, 1, ifelse(hiv == &quot;Non-reactive&quot;, 0, NA)),
      education = forcats::fct_relevel(education, c(&quot;Less than 9th grade&quot;, &quot;9-11th grade&quot;, &quot;High school graduate or equivalent&quot;, &quot;Some college or AA degree&quot;, &quot;College graduate or above&quot;)),
      race = forcats::fct_relevel(race, c(&quot;Non-Hispanic White&quot;, &quot;Mexican American&quot;, &quot;Non-Hispanic Black&quot;, &quot;Other Hispanic&quot;, &quot;Other Race - Including Multi-Racial&quot;)),
      marriage = forcats::fct_relevel(marriage, c(&quot;Married&quot;, &quot;Widowed&quot;, &quot;Divorced&quot;, &quot;Separated&quot;, &quot;Never married&quot;, &quot;Living with partner&quot;))
         )</code></pre>
<p>I set “Less than 9th grade” as the reference group for the
<code>education</code> variable; “Non-Hispanic White” as the reference
group for the <code>race</code> variable; “Married” as the reference
group for the <code>marriage</code> variable.</p>
</div>
<div id="bivariate-analysis" class="section level2">
<h2>Bivariate analysis</h2>
<pre class="r"><code>variables = c(&quot;age&quot;,&quot;gender&quot;,&quot;education&quot;,&quot;race&quot;,&quot;samesexcontact&quot;,&quot;marriage&quot;)

fit_and_summarize &lt;- function(var) {
  model = glm(as.formula(paste(&quot;hiv_outcome~&quot;, var)), data = cleaned_regression_df, family = binomial()) |&gt;
  broom::tidy()
}

model_summaries = 
  map(variables, fit_and_summarize) |&gt;
  bind_rows() |&gt;
  filter(p.value &lt;= 0.008 &amp; term != &quot;(Intercept)&quot;)

model_summaries |&gt;
  select(term, estimate, p.value) |&gt;
  knitr::kable(digits = 3)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">age</td>
<td align="right">0.037</td>
<td align="right">0.001</td>
</tr>
<tr class="even">
<td align="left">genderMale</td>
<td align="right">1.107</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">raceNon-Hispanic Black</td>
<td align="right">2.302</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">samesexcontact</td>
<td align="right">2.854</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">marriageNever married</td>
<td align="right">1.407</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">marriageLiving with partner</td>
<td align="right">1.004</td>
<td align="right">0.001</td>
</tr>
</tbody>
</table>
<p>Because I am conducting 6 logistic tests, the Bonferroni-corrected
significance level would be 0.05/6 = 0.008. Variables <code>age</code>,
<code>gender</code>, <code>race</code>, <code>samesexcontact</code>,
<code>marriage</code> were found significant associated with HIV
infection status, at 0.8% level of significance. Therefore, these
variables were included to the final model.</p>
</div>
<div id="the-final-model" class="section level2">
<h2>The final model</h2>
<pre class="r"><code>fit_regression = cleaned_regression_df |&gt; 
  glm(hiv_outcome ~ samesexcontact + gender + age + race + marriage, data = _, family = binomial()) 

fit_regression|&gt; 
  broom::tidy() |&gt; 
  mutate(OR = exp(estimate)) |&gt; 
  select(term, estimate, OR, p.value)|&gt; 
  knitr::kable(digits = 3)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">OR</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-10.460</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">samesexcontact</td>
<td align="right">2.834</td>
<td align="right">17.020</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">genderMale</td>
<td align="right">1.820</td>
<td align="right">6.171</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">0.056</td>
<td align="right">1.058</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">raceMexican American</td>
<td align="right">0.455</td>
<td align="right">1.576</td>
<td align="right">0.324</td>
</tr>
<tr class="even">
<td align="left">raceNon-Hispanic Black</td>
<td align="right">2.072</td>
<td align="right">7.941</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">raceOther Hispanic</td>
<td align="right">1.245</td>
<td align="right">3.473</td>
<td align="right">0.009</td>
</tr>
<tr class="even">
<td align="left">raceOther Race - Including Multi-Racial</td>
<td align="right">-14.286</td>
<td align="right">0.000</td>
<td align="right">0.978</td>
</tr>
<tr class="odd">
<td align="left">marriageWidowed</td>
<td align="right">2.036</td>
<td align="right">7.661</td>
<td align="right">0.066</td>
</tr>
<tr class="even">
<td align="left">marriageDivorced</td>
<td align="right">1.138</td>
<td align="right">3.121</td>
<td align="right">0.036</td>
</tr>
<tr class="odd">
<td align="left">marriageSeparated</td>
<td align="right">1.406</td>
<td align="right">4.080</td>
<td align="right">0.020</td>
</tr>
<tr class="even">
<td align="left">marriageNever married</td>
<td align="right">1.341</td>
<td align="right">3.823</td>
<td align="right">0.002</td>
</tr>
<tr class="odd">
<td align="left">marriageLiving with partner</td>
<td align="right">1.033</td>
<td align="right">2.811</td>
<td align="right">0.040</td>
</tr>
</tbody>
</table>
<p><strong>Logistic regression results:</strong></p>
<ul>
<li>The logistic regression analysis reveals several key risk factors
associated with HIV in the US.
<ul>
<li>Individuals reporting same-sex contacts exhibit a significant
increase in the odds of being HIV positive (OR = 17.020), emphasizing
the importance of considering sexual behavior in HIV risk
assessment.</li>
<li>Gender is also a significant predictor, with males having 6.171
times higher odds of being HIV positive compared to females.</li>
<li>Age demonstrates a positive association, indicating a slight
increase in HIV odds with 1-year increase in age (OR = 1.058).</li>
<li>Among racial categories, Non-Hispanic Black individuals show the
highest risk (OR = 7.941), while Mexican Americans do not exhibit a
statistically significant association.</li>
<li>Regarding marital status, divorced, separated, and never married
individuals display elevated odds of being HIV positive, suggesting that
certain relationship statuses may contribute to increased
vulnerability.</li>
</ul></li>
<li>These findings underscore the complex interplay of demographic
factors in HIV risk and contribute valuable insights for targeted
prevention and intervention strategies.</li>
</ul>
</div>
<div id="bootstrap" class="section level2">
<h2>Bootstrap</h2>
<pre class="r"><code>bootstrap_df =
  cleaned_regression_df |&gt; 
  bootstrap(n = 500) |&gt; 
  mutate(
    models = map(.x = strap, ~glm(hiv_outcome ~ samesexcontact + gender + age + race + marriage, data = .x, family = binomial()) ),
    results = map(models, broom::tidy)) |&gt; 
  select(-strap, -models) |&gt; 
  unnest(results) |&gt; 
  group_by(term) |&gt; 
  mutate(OR = exp(estimate))</code></pre>
</div>
<div id="distribution-of-estimates-under-repeated-sampling"
class="section level2">
<h2>Distribution of estimates under repeated sampling</h2>
<pre class="r"><code>bootstrap_df|&gt; 
  filter(term == &quot;age&quot;) |&gt; 
  ggplot(aes(x = estimate))+
  geom_density() +
  facet_wrap(.~ term)  </code></pre>
<p><img src="NHANES_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code>bootstrap_df|&gt; 
  filter(term != &quot;age&quot;) |&gt; 
  ggplot(aes(x = estimate))+
  geom_density() +
  facet_wrap(.~ term)</code></pre>
<p><img src="NHANES_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
<ul>
<li>This is the uncertainty that we would get in this dataset if we do
repeated sampling</li>
</ul>
</div>
<div id="bootstrap-mean-or-and-95-ci" class="section level2">
<h2>Bootstrap mean OR and 95% CI</h2>
<pre class="r"><code>bootstrap_df|&gt; 
  summarize(
    mean_OR = mean(OR),
    CI_lower = quantile(OR, 0.025),
    CI_upper = quantile(OR, 0.975)
    )|&gt; 
  knitr::kable(digits = 3)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">mean_OR</th>
<th align="right">CI_lower</th>
<th align="right">CI_upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">1.058</td>
<td align="right">1.029</td>
<td align="right">1.087</td>
</tr>
<tr class="odd">
<td align="left">genderMale</td>
<td align="right">6.852</td>
<td align="right">3.358</td>
<td align="right">13.781</td>
</tr>
<tr class="even">
<td align="left">marriageDivorced</td>
<td align="right">3.787</td>
<td align="right">0.964</td>
<td align="right">10.798</td>
</tr>
<tr class="odd">
<td align="left">marriageLiving with partner</td>
<td align="right">3.273</td>
<td align="right">1.041</td>
<td align="right">9.157</td>
</tr>
<tr class="even">
<td align="left">marriageNever married</td>
<td align="right">4.597</td>
<td align="right">1.674</td>
<td align="right">11.652</td>
</tr>
<tr class="odd">
<td align="left">marriageSeparated</td>
<td align="right">4.869</td>
<td align="right">0.617</td>
<td align="right">14.526</td>
</tr>
<tr class="even">
<td align="left">marriageWidowed</td>
<td align="right">10.891</td>
<td align="right">0.000</td>
<td align="right">48.962</td>
</tr>
<tr class="odd">
<td align="left">raceMexican American</td>
<td align="right">1.713</td>
<td align="right">0.555</td>
<td align="right">3.710</td>
</tr>
<tr class="even">
<td align="left">raceNon-Hispanic Black</td>
<td align="right">8.804</td>
<td align="right">4.422</td>
<td align="right">16.874</td>
</tr>
<tr class="odd">
<td align="left">raceOther Hispanic</td>
<td align="right">3.820</td>
<td align="right">1.236</td>
<td align="right">9.117</td>
</tr>
<tr class="even">
<td align="left">raceOther Race - Including Multi-Racial</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">samesexcontact</td>
<td align="right">18.864</td>
<td align="right">10.521</td>
<td align="right">31.664</td>
</tr>
</tbody>
</table>
<p><strong>Bootstrap Confidence Intervals:</strong></p>
<ul>
<li>The bootstrap analysis yields informative insights into the
association between various sociodemographic factors and HIV outcomes.
<ul>
<li>Notably, the wide 95% confidence intervals (CI) for most variables,
excluding age, suggest substantial uncertainty in the estimated odds
ratios. Same-sex behavior stands out with a mean odds ratio of 18.499
and a relatively narrow CI (10.862 to 31.096), indicating a robust
positive association with HIV risk.</li>
<li>In contrast, factors like “Male” “Divorced” “Living with partner”
“Never married” “Separated” “Widowed” “Mexican American” “Non-Hispanic
Black” and “Other Hispanic” exhibit wide CIs, signifying considerable
variability in their associations with HIV.</li>
</ul></li>
<li>The broad 95% CI underscores the uncertainty in the magnitude of
these associations and suggests a need for caution in drawing definitive
conclusions. This may be attributed to sample variability or other
unaccounted factors influencing the observed relationships.</li>
</ul>
</div>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p>The logistic regression and bootstrap analyses indicate that several
demographic factors are associated with HIV outcomes, same-sex behavior
showing a particularly strong positive association. However, the wide
95% confidence intervals for most variables, excluding age, show
significant uncertainty in the estimated odds ratios, highlighting the
limitations of the study. These broad intervals may stem from sample
variability or unaccounted confounders, necessitating caution in drawing
definitive conclusions.</p>
<p>Therefore, future research should explore larger and more diverse
datasets to enhance the generalizability of findings and address
potential sources of variability. Additionally, a thorough investigation
into the complex interplay between demographic variables and HIV risk,
considering potential interactions and subgroup analyses, could provide
a more nuanced understanding of these associations. Moreover, the study
could benefit from incorporating behavioral and contextual factors that
might contribute to HIV risk.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
